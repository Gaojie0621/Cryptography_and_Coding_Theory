# 循环码
## **循环码概述**

### **背景与发展**
1. **第一阶段（普通码）**：码定义为 **Bⁿ** 的非空子集（第10讲）
2. **第二阶段（线性码）**：要求码字对加法封闭，引入代数结构（第11讲）
3. **第三阶段（循环码）**：进一步要求码字对**循环移位**封闭，这是本节课的内容

### **循环码的重要性**
- 可以构造**高效的多错误纠正码**，如BCH码、Reed-Solomon码
- **易于计算机实现**（使用移位寄存器等简单硬件）
- 在通信和存储系统中应用广泛


## **一、循环码的定义**

### **正式定义**
一个线性码 **C** 称为**循环码**，如果每个码字的**循环右移**仍然是码字。

**数学表述**：
若 $c_1c_2c_3 \ldots c_n \in C$，则 $c_nc_1c_2 \ldots c_{n-1} \in C$

**关键点**：
- **循环码一定是线性码**（定义中隐含了线性条件）
- 循环移位：把最后一位移到最前面，其他位向右移动

### **示例分析**

#### **例1：循环码**
- **C₁ = {000, 011, 101, 110}**
  - `011` 右移 → `101` ∈ C₁ ✓
  - `101` 右移 → `110` ∈ C₁ ✓
  - `110` 右移 → `011` ∈ C₁ ✓
  - **是循环码**

- **C₂ = {000000, 010101, 101010, 111111}**
  - `010101` 右移 → `101010` ∈ C₂ ✓
  - `101010` 右移 → `010101` ∈ C₂ ✓
  - **是循环码**

#### **例2：非循环码**
- **C₃ = {000, 001, 010, 100}**
  - 首先**不是线性码**（不满足加法封闭性）
  - 因此**不是循环码**（循环码必须是线性码）

- **C = {00000, 00101, 01011, 01110, 10010, 10111, 11001, 11100}**
  - 检查线性性：是线性码 ✓
  - 检查循环性：`00101` 右移 → `10010` ∈ C ✓
    `10010` 右移 → `01001` ∉ C ✗
  - **是线性码，但不是循环码**


## **二、多项式表示法**

### **基本对应关系**
将二进制字与多项式建立一一对应：

$$
a_0a_1a_2 \ldots a_{n-1} \in \mathbb{B}^n \quad \leftrightarrow \quad a_0 + a_1x + a_2x^2 + \cdots + a_{n-1}x^{n-1} \in \mathbb{Z}_2[x]
$$

**示例**：
- 字 `101110` ↔ 多项式 $1 + x^2 + x^3 + x^4$
- 右移后 `010111` ↔ 多项式 $x + x^3 + x^4 + x^5$

### **循环移位的多项式表示**

**定理 3.1**：
设字 `a` 对应多项式 $f_1(x)$，其循环右移后的字对应多项式 $f_2(x)$，则：

$$
f_2(x) \equiv x f_1(x) \pmod{x^n - 1}
$$

**推导**：
对于 $a = a_0a_1 \ldots a_{n-1}$：
- $f_1(x) = a_0 + a_1x + \cdots + a_{n-1}x^{n-1}$
- $x f_1(x) = a_0x + a_1x^2 + \cdots + a_{n-1}x^n$
- 由于 $x^n \equiv 1 \pmod{x^n - 1}$，上式 ≡ $a_{n-1} + a_0x + \cdots + a_{n-2}x^{n-1}$
- 这正是右移后的多项式 $f_2(x)$

### **多次移位的计算方法**
进行 k 次右移：
1. 乘以 $x^k$
2. 用 1 替换所有 $x^n$（模 $x^n - 1$ 约简）
3. 重复直到次数 < n

**示例**：
对于 n=7， $f(x) = x + x^4 + x^5$（对应 `0100110`）
进行3次右移：

$$
x^3 f(x) = x^4 + x^7 + x^8 = x^4 + 1 + x = 1 + x + x^4
$$

对应 `1100100`，确实是 `0100110` 右移3次的结果。

## **三、循环码的核心定理**

### **定理 3.2 内容**
设 **C** 是 **Bⁿ** 中的循环码， $P_C$ 是对应的多项式集合。选择 $P_C$ 中**次数最小**的非零多项式 $g(x)$，设 $s = \deg g(x)$。则：

#### **(i) 唯一性**
$g(x)$ 是唯一确定的（称为**生成多项式**）

#### **(ii) 整除性**
$g(x)$ 整除 $x^n - 1$：

$$
g(x)h(x) = x^n - 1
$$

其中 $h(x)$ 称为**校验多项式**

#### **(iii) 生成所有码字**
对于任意 $f(x) \in \mathbb{Z}_2[x]$ 且 $\deg f(x) \leq n-s-1$：

$$
g(x)f(x) \in P_C
$$

即所有次数 ≤ $n-s-1$ 的多项式乘以 $g(x)$ 得到所有码字多项式

#### **(iv) 维度**
码的维度为 $n-s$，即 **C** 是 $[n, n-s]$-码

#### **(v) 码字判定条件**
多项式 $m(x)$（次数 < n）对应码字 ⇔ $m(x)h(x) ≡ 0 \pmod{x^n - 1}$

## **四、示例：分析 C₁ 码**

### **码 C₁ = {000, 011, 101, 110}**
- 多项式表示： $P_{C₁} = \{0, x+x^2, 1+x^2, 1+x\}$
- 最小次数非零多项式： $g(x) = 1+x$（次数 s=1）
- 维度： $k = n-s = 3-1 = 2$，确实是 [3,2]-码

### **验证定理性质**
1. **唯一性**：只有 $1+x$ 次数为1 ✓
2. **整除性**： $x^3 - 1 = (1+x)(1+x+x^2) = g(x)h(x)$ ✓
3. **生成码字**：次数 ≤ $n-s-1 = 1$ 的 $f(x)$ 有：0, 1, x, 1+x
   - $0·g(x) = 0$
   - $1·g(x) = 1+x$ ↔ `110`
   - $x·g(x) = x+x^2$ ↔ `011`
   - $(1+x)·g(x) = 1+x^2$ ↔ `101`
   正好是 $P_{C₁}$ 中的所有多项式 ✓

### **错误检测应用**
校验多项式 $h(x) = 1+x+x^2$
- 接收 `101`（码字）： $m_1(x) = 1+x^2$
  $m_1(x)h(x) = (1+x^2)(1+x+x^2) ≡ 0 \pmod{x^3-1}$ ✓
- 接收 `010`（非码字）： $m_2(x) = x$
  $m_2(x)h(x) = x(1+x+x^2) ≡ 1+x+x^2 ≠ 0$ ✗

## 思考
### **1. 为什么循环码必须是线性码？**

### **定义回顾**
在讲义的**定义部分**明确指出：
> "A linear code $C$ is called _cyclic_ if..."

这意味着**循环码是线性码的一个子类**。循环性的定义**建立在**线性性的基础上。

### **逻辑关系**
```
所有循环码 ⊆ 所有线性码 ⊆ 所有码
```

**为什么这样定义？**
1. **历史与实用原因**：研究者发现，在线性码上增加循环性约束，可以得到结构更优美、更易实现的码。如果允许非线性，理论会变得非常复杂。
2. **代数结构需要**：多项式表示法（模 $x^n-1$ 运算）天然对应**线性**运算：
   - 多项式加法 ↔ 码字按位模2加
   - 多项式乘以 $x$ ↔ 循环移位
   这些运算在线性空间下才封闭。
3. **定理依赖线性性**：生成多项式 $g(x)$ 能生成所有码字的关键定理，依赖线性性。

## **2. 为什么 $g(x)$ 可以生成所有码字？**

### **定理证明思路**

设 **C** 是循环码， $P_C$ 是对应的次数 < n 的多项式集合。

#### **第一步：选择 $g(x)$**
取 $P_C$ 中**次数最小**的非零多项式，设其次数为 $s$，记作 $g(x)$。

**关键观察 1**：由于循环性， $x·g(x) \ (\text{mod } x^n-1)$ 也在 $P_C$ 中。

#### **第二步：证明 $g(x)$ 整除 $x^n-1$**
1. 用 $g(x)$ 除 $x^n-1$（在 $\mathbb{Z}_2[x]$ 中）：

$$
x^n - 1 = q(x)g(x) + r(x), \quad \deg r(x) < s
$$

2. 由于循环性， $x^n \equiv 1 \ (\text{mod } x^n-1)$，考虑多项式 $q(x)g(x)$：
   - $g(x) \in P_C$ ⇒ 循环移位得到的多项式也在 $P_C$ 中
   - 通过循环移位可构造出 $q(x)g(x) \ (\text{mod } x^n-1) \in P_C$
3. 所以 $r(x) = (x^n-1) - q(x)g(x) \in P_C$（因为 $P_C$ 是线性空间）
4. 但 $\deg r(x) < s$，而 $g(x)$ 是次数最小的非零多项式 ⇒ $r(x) = 0$
5. 因此 $x^n - 1 = q(x)g(x)$，即 $g(x)$ 整除 $x^n - 1$

设 $h(x) = q(x)$，则 $g(x)h(x) = x^n - 1$。

#### **第三步：证明所有 $f(x)g(x)$（次数 < n）都是码字**

**引理**：对于任意多项式 $f(x)$，次数 < n 的 $f(x)g(x) \ (\text{mod } x^n-1)$ 属于 $P_C$。

**证明**：
1. 将 $f(x)$ 写成： $f(x) = a_0 + a_1x + \cdots + a_{n-1}x^{n-1}$
2. 则 $f(x)g(x) = a_0g(x) + a_1[x g(x)] + a_2[x^2 g(x)] + \cdots$
3. 由于 $g(x) \in P_C$ 且 **C 是循环码**：
   - $g(x) \in P_C$
   - $x g(x) \ (\text{mod } x^n-1) \in P_C$（循环右移一次）
   - $x^2 g(x) \ (\text{mod } x^n-1) \in P_C$（循环右移两次）
   - ...
4. 又因为 **C 是线性码**（ $P_C$ 对加法封闭），所以这些项的线性组合仍在 $P_C$ 中
5. 因此 $f(x)g(x) \ (\text{mod } x^n-1) \in P_C$

#### **第四步：为什么只需考虑 $\deg f(x) \leq n-s-1$？**

设 $\deg f(x) = d$，则：

$$
\deg [g(x)f(x)] = s + d
$$

如果要求 $g(x)f(x)$ 的次数 < n（即直接对应码字多项式，不需要模约简），则需要：

$$
s + d < n \quad \Rightarrow \quad d < n - s
$$

即 $\deg f(x) \leq n-s-1$。

**注意**：如果 $\deg f(x) \geq n-s$，则 $g(x)f(x)$ 的次数 ≥ n，需要模 $x^n-1$ 约简，但约简后仍然对应某个次数 ≤ n-s-1 的 $f'(x)$ 乘以 $g(x)$。

所以：**所有码字多项式 = { $g(x)f(x) \ (\text{mod } x^n-1)$ | $f(x)$ 任意 }  
= { $g(x)f(x)$ | $\deg f(x) \leq n-s-1$ }**

### **第五步：维度为什么是 $n-s$？**

1. 不同 $f(x)$ 给出不同码字（因为 $g(x)$ 固定且非零）
2. 次数 ≤ $n-s-1$ 的多项式有 $2^{n-s}$ 个（系数在 $\mathbb{Z}_2$）
3. 因此码字数 = $2^{n-s}$，维度 $k = n-s$


## **五、循环码的构造方法**

### **构造步骤**
要构造一个循环 $[n,k]$-码：

1. **选择生成多项式** $g(x)$：
   - 必须是 $x^n - 1$ 的因子
   - 次数必须为 $n-k$
   - 注意：对于某些 n,k，可能不存在这样的 $g(x)$

2. **生成码字**：
   所有码字多项式形如 $f(x)g(x)$，其中 $\deg f(x) ≤ k-1$

### **示例：构造 [7,3]-循环码**
已知： $x^7 - 1 = (1+x)(1+x+x^3)(1+x^2+x^3)$

**步骤**：
- 需要次数为 $n-k = 7-3 = 4$ 的因子
- 两种选择：
  1. $g_1(x) = (1+x)(1+x+x^3) = 1 + x^2 + x^3 + x^4$
  2. $g_2(x) = (1+x)(1+x^2+x^3) = 1 + x + x^2 + x^4$

选择第一种，则：
- 生成多项式： $g(x) = 1 + x^2 + x^3 + x^4$
- 校验多项式： $h(x) = 1 + x^2 + x^3$（剩余因子）

**编码表**：
| 信息字 | f(x) | f(x)g(x) | 码字 |
|--------|------|----------|------|
| 000 | 0 | 0 | 0000000 |
| 001 | x² | x²+x⁴+x⁵+x⁶ | 0010111 |
| 010 | x | x+x³+x⁴+x⁵ | 0101110 |
| 011 | x+x² | x+x²+x³+x⁶ | 0111001 |
| 100 | 1 | 1+x²+x³+x⁴ | 1011100 |
| 101 | 1+x² | 1+x³+x⁵+x⁶ | 1001011 |
| 110 | 1+x | 1+x+x²+x⁵ | 1110010 |
| 111 | 1+x+x² | 1+x+x⁴+x⁶ | 1100101 |

## **六、循环码的生成矩阵与校验矩阵**

### **生成矩阵的构造**
设生成多项式 $g(x) = a₀ + a₁x + \cdots + aₘx^m$（其中 $m = n-k$）

则生成矩阵为：

$$
G = \begin{pmatrix}
a₀ & a₁ & \cdots & aₘ & 0 & \cdots & 0 \\
0 & a₀ & \cdots & aₘ₋₁ & aₘ & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
0 & \cdots & 0 & a₀ & a₁ & \cdots & aₘ
\end{pmatrix}_{k×n}
$$

**结构特点**：每行是上一行右移一位，最后补零

**示例**：对于 [7,3]-码， $g(x) = 1 + x^2 + x^3 + x^4$

$$
G = \begin{pmatrix}
1 & 0 & 1 & 1 & 1 & 0 & 0 \\
0 & 1 & 0 & 1 & 1 & 1 & 0 \\
0 & 0 & 1 & 0 & 1 & 1 & 1
\end{pmatrix}
$$

### **校验矩阵的构造**
设校验多项式 $h(x) = b₀ + b₁x + \cdots + bₖx^k$

先构造 $(n-k)×n$ 矩阵：

$$
H_1 = \begin{pmatrix}
b_k & b_{k-1} & \cdots & b₀ & 0 & \cdots & 0 \\
0 & b_k & \cdots & b₁ & b₀ & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots & \vdots & \ddots & \vdots \\
0 & \cdots & 0 & b_k & b_{k-1} & \cdots & b₀
\end{pmatrix}
$$

然后取转置： $H = H_1^T$ 即为校验矩阵

**示例**：对于 [7,3]-码， $h(x) = 1 + x^2 + x^3$
- $b₀=1, b₁=0, b₂=1, b₃=1, k=3$

$$
H_1 = \begin{pmatrix}
1 & 1 & 0 & 1 & 0 & 0 & 0 \\
0 & 1 & 1 & 0 & 1 & 0 & 0 \\
0 & 0 & 1 & 1 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & 1 & 0 & 1
\end{pmatrix}
$$

$$
H = H_1^T = \begin{pmatrix}
1 & 0 & 0 & 0 \\
1 & 1 & 0 & 0 \\
0 & 1 & 1 & 0 \\
1 & 0 & 1 & 1 \\
0 & 1 & 0 & 1 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{pmatrix}
$$

## **七、循环码的性质总结**

| 性质 | 说明 |
|------|------|
| **代数结构** | 线性码 + 循环移位封闭性 |
| **多项式表示** | 字 ↔ 次数 ≤ n-1 的多项式 |
| **生成多项式** | 次数最小的非零码字多项式，唯一且整除 $x^n-1$ |
| **校验多项式** | $g(x)h(x) = x^n-1$，用于错误检测 |
| **维度** | $k = n - \deg g(x)$ |
| **编码** | 信息多项式 $f(x)$ → 码字多项式 $f(x)g(x)$ |
| **生成矩阵** | 由 $g(x)$ 系数循环移位构成 |
| **校验矩阵** | 由 $h(x)$ 系数循环移位构成后转置 |
| **错误检测** | 接收多项式 $m(x)$ 是码字 ⇔ $m(x)h(x) ≡ 0 \pmod{x^n-1}$ |

## **八、循环码的优势与应用**

### **理论优势**
1. **结构丰富**：兼具线性结构和循环结构
2. **代数工具强大**：可用多项式环理论分析
3. **参数灵活**：通过选择不同的 $g(x)$ 得到不同性能的码

### **实践优势**
1. **编码简单**：只需多项式乘法（可用移位寄存器实现）
2. **译码高效**：有专门的译码算法（如Meggit译码器）
3. **硬件友好**：适合集成电路实现

### **重要子类**
- **汉明码的循环形式**：可以表示为循环码
- **BCH码**：基于有限域的多错误纠正循环码
- **Reed-Solomon码**：非二进制循环码，用于CD、DVD等
- **CRC码**：循环冗余校验码，用于错误检测


## **关键理解要点**

1. **循环性 = 线性 + 移位封闭**：两者缺一不可
2. **生成多项式的核心地位**：决定了码的所有性质
3. **模 $x^n-1$ 运算**：这是循环移位的数学本质
4. **因式分解是关键**：构造循环码需要分解 $x^n-1$
5. **系统形式**：循环码也可以写成系统形式（信息位在前）

循环码将抽象的编码问题转化为**多项式环中的理想**问题，这是编码理论从组合方法转向代数方法的标志性进展。